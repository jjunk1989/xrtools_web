<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebXR 视频播放器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f4f4f4;
        }

        .container {
            text-align: center;
        }

        video {
            width: 80%;
            max-width: 800px;
            border: 2px solid #4CAF50;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>WebXR 视频播放器</h1>
        <button id="enterXR">进入 VR 模式</button>
    </div>

    <script>
        // 检查 WebXR 支持
        if (navigator.xr) {
            document.getElementById('enterXR').addEventListener('click', async () => {
                const video = document.getElementById('videoPlayer');
                const xrSession = await navigator.xr.requestSession('immersive-vr');
                const gl = document.createElement('canvas').getContext('webgl', { xrCompatible: true });
                xrSession.updateRenderState({ baseLayer: new XRWebGLLayer(xrSession, gl) });

                const onXRFrame = (time, frame) => {
                    const session = frame.session;
                    session.requestAnimationFrame(onXRFrame);
                    const pose = frame.getViewerPose(xrSession.renderState.baseLayer.getReferenceSpace());

                    if (pose) {
                        const glLayer = session.renderState.baseLayer;
                        gl.bindFramebuffer(gl.FRAMEBUFFER, glLayer.framebuffer);
                        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);

                        // 在这里渲染视频帧
                        // 你可以使用 WebGL 将视频帧渲染到 VR 视图中
                    }
                };

                xrSession.requestAnimationFrame(onXRFrame);

                // 开始播放视频
                video.play();
            });
        } else {
            document.getElementById('enterXR').innerText = 'WebXR 不受支持';
            document.getElementById('enterXR').disabled = true;
        }
    </script>
</body>
</html>